<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>模拟退火算法 - TSP旅行商问题求解 | Yiyuery</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/favicon.ico">
    <meta name="description" content="Yiyuery's 个人博客">
    <link rel="preload" href="/assets/css/0.styles.fac40609.css" as="style"><link rel="preload" href="/assets/js/app.839ced15.js" as="script"><link rel="preload" href="/assets/js/4.3fbc1f96.js" as="script"><link rel="preload" href="/assets/js/20.979ad63c.js" as="script"><link rel="prefetch" href="/assets/js/1.43a347b2.js"><link rel="prefetch" href="/assets/js/10.9753ee5d.js"><link rel="prefetch" href="/assets/js/11.96c59566.js"><link rel="prefetch" href="/assets/js/12.2c50efec.js"><link rel="prefetch" href="/assets/js/13.5d6e55a8.js"><link rel="prefetch" href="/assets/js/14.fc442e96.js"><link rel="prefetch" href="/assets/js/15.24339c79.js"><link rel="prefetch" href="/assets/js/16.1587d289.js"><link rel="prefetch" href="/assets/js/17.44142bfd.js"><link rel="prefetch" href="/assets/js/18.994bb200.js"><link rel="prefetch" href="/assets/js/19.ca759cda.js"><link rel="prefetch" href="/assets/js/2.52d476cc.js"><link rel="prefetch" href="/assets/js/21.fecc9d80.js"><link rel="prefetch" href="/assets/js/22.3e99d924.js"><link rel="prefetch" href="/assets/js/23.951d9b97.js"><link rel="prefetch" href="/assets/js/24.bad04352.js"><link rel="prefetch" href="/assets/js/25.ce195067.js"><link rel="prefetch" href="/assets/js/26.7b3581a7.js"><link rel="prefetch" href="/assets/js/27.efc77ae3.js"><link rel="prefetch" href="/assets/js/28.16eb2f91.js"><link rel="prefetch" href="/assets/js/29.7772d15e.js"><link rel="prefetch" href="/assets/js/30.3870d4d1.js"><link rel="prefetch" href="/assets/js/31.0f4cfbf5.js"><link rel="prefetch" href="/assets/js/32.29d81c04.js"><link rel="prefetch" href="/assets/js/33.28affd1f.js"><link rel="prefetch" href="/assets/js/34.d28c7114.js"><link rel="prefetch" href="/assets/js/35.d7bb0604.js"><link rel="prefetch" href="/assets/js/36.ebab3576.js"><link rel="prefetch" href="/assets/js/37.0eb5a00d.js"><link rel="prefetch" href="/assets/js/38.9db427c3.js"><link rel="prefetch" href="/assets/js/39.53ecfed9.js"><link rel="prefetch" href="/assets/js/40.b2df18d9.js"><link rel="prefetch" href="/assets/js/41.b6970575.js"><link rel="prefetch" href="/assets/js/42.5d438713.js"><link rel="prefetch" href="/assets/js/43.0f984b43.js"><link rel="prefetch" href="/assets/js/44.4a9567c2.js"><link rel="prefetch" href="/assets/js/45.e77b2e3a.js"><link rel="prefetch" href="/assets/js/46.db689d82.js"><link rel="prefetch" href="/assets/js/47.ca290c98.js"><link rel="prefetch" href="/assets/js/48.cc29300b.js"><link rel="prefetch" href="/assets/js/49.f43fa070.js"><link rel="prefetch" href="/assets/js/5.8663838d.js"><link rel="prefetch" href="/assets/js/50.5ac4404a.js"><link rel="prefetch" href="/assets/js/51.20121ae0.js"><link rel="prefetch" href="/assets/js/52.d225ba88.js"><link rel="prefetch" href="/assets/js/53.adeb5a3a.js"><link rel="prefetch" href="/assets/js/54.a4dc7855.js"><link rel="prefetch" href="/assets/js/55.4b88ddc7.js"><link rel="prefetch" href="/assets/js/56.a13331f5.js"><link rel="prefetch" href="/assets/js/57.885d087b.js"><link rel="prefetch" href="/assets/js/58.a3064fd9.js"><link rel="prefetch" href="/assets/js/59.7e0d1f6e.js"><link rel="prefetch" href="/assets/js/6.83d9063b.js"><link rel="prefetch" href="/assets/js/60.33d66471.js"><link rel="prefetch" href="/assets/js/61.d332eaa5.js"><link rel="prefetch" href="/assets/js/62.8eaf5a15.js"><link rel="prefetch" href="/assets/js/63.6e0c7f61.js"><link rel="prefetch" href="/assets/js/64.17534d3f.js"><link rel="prefetch" href="/assets/js/65.40d814d7.js"><link rel="prefetch" href="/assets/js/66.9279a738.js"><link rel="prefetch" href="/assets/js/67.5cdb9fd6.js"><link rel="prefetch" href="/assets/js/68.26c5c99d.js"><link rel="prefetch" href="/assets/js/69.d349f923.js"><link rel="prefetch" href="/assets/js/7.6cb83fee.js"><link rel="prefetch" href="/assets/js/8.d6104416.js"><link rel="prefetch" href="/assets/js/9.c85ef583.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fac40609.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><!----> <div id="my-bg"></div> <header class="navbar my-nav"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logoko.png" alt="Yiyuery" class="logo"> <span class="site-name can-hide">Yiyuery</span></a> <div class="links"><div class="color-picker"><a class="color-button">
		切换
	</a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">切换主题</h4> <ul class="color-mode-options"><li class="dark">暗</li><li class="auto active">自动</li><li class="light">亮</li></ul></div></div></div> <!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">📃 文章</a></div><div class="nav-item"><a href="/zhuanlan/" class="nav-link">📰 专栏</a></div><div class="nav-item"><a href="/zone/" class="nav-link">🤪 动态</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">🔨 工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">🚥 导航</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">🔗 友链</a></li></ul></div></div> <!----></nav> <a href="https://github.com/Yiyuery/" target="_blank" class="can-hide" style="display: flex; align-items: center; margin-left: 10px;"><img src="/github.png" class="my-svg" style="width: 1.4rem; height: 1.4rem;"></a></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">📃 文章</a></div><div class="nav-item"><a href="/zhuanlan/" class="nav-link">📰 专栏</a></div><div class="nav-item"><a href="/zone/" class="nav-link">🤪 动态</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">🔨 工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">🚥 导航</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">🔗 友链</a></li></ul></div></div> <!----></nav>  <!----> </aside> <div><main class="page need-zoom"> <div class="my-main"><div class="my-main-left"><div class="my-title-box"><h2>模拟退火算法 - TSP旅行商问题求解</h2> <div class="my-title-info"><span id="/Simulated-annealing-algorithm/" data-flag-title="模拟退火算法 - TSP旅行商问题求解" class="leancloud-visitors"><span>作者：玉川</span>  
            <span>2020 年 3 月 24 日  </span> <i class="el-icon-view" style="margin-right: 3px;"></i> <span class="leancloud-visitors-count"></span></span></div></div> <div class="theme-default-content content__default"><p>一个锅底凹凸不平有很多坑的大锅，晃动这个锅使得一个小球使其达到全局最低点。一开始晃得比较厉害，小球的变化也就比较大，在趋于全局最低的时候慢慢减小晃锅的幅度，直到最后不晃锅，小球达到全局最低。</p> <h2 id="固体退火过程"><a href="#固体退火过程" class="header-anchor">#</a> 固体退火过程</h2> <p>模拟退火算法是由复杂组合优化问题与固体的退火过程之间的相似之处，在它们之间建立联系而提出来的。固体的退火过程是一种物理现象，属于热力学和统计物理学的研究范畴。</p> <p>固体退火过程能最终达到最小能量的一个状态，从理论上来说，必须满足4个条件：</p> <ol><li>初始温度必须足够高；</li> <li>在每个温度下，状态的交换必须足够充分；</li> <li>温度的下降必须足够缓慢；</li> <li>最终温度必须足够低。</li></ol> <h2 id="模拟退火算法"><a href="#模拟退火算法" class="header-anchor">#</a> 模拟退火算法</h2> <p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/blog/20200323/d4ukj7kp959Y.png" alt="mark"></p> <p>组合优化问题与固体退火过程的类比</p> <p>组合优化问题与固体退火过程有其类似性，将组合优化问题类比为固体的退火过程，便提出了求解组合优化问题的模拟退火算法。</p> <p>在求解组合优化问题时，首先给定一个比较大的t值，这相当于一个比较高的温度T。随机给定一个问题的解i，作为问题的初始解。在给定的 t 下，随机产生一个问题的解 j ，j ∈ N(i)，其中 N(i) 是 i 的邻域。从解 i 到新解 j 的转移概率，按照 Metropolis 准则确定：</p> <p></p><p>P_{t}(i \Rightarrow j)=\left\{\begin{array}{ll}
1 &amp; f(j)&lt;f(i) \\
e^{-\frac{j(j)}{t}, f(i)} &amp; \text { other }
\end{array}\right.</p><p></p> <p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/blog/20200323/lQKsFgHswh3S.png" alt="mark"></p> <p>如果新解 j 被接受，则以解 j 代替解i，否则继续保持解 i 。重复该过程，直到在该控制参数 t 下达到平衡。</p> <p>与退火过程中的温度T缓慢下降相对应，在进行足够多的状态转移之后，控制参数t要缓慢下降，并在每个参数t下，重复以上过程，直到控制参数 t 降低到足够小为止。最终得到的是该组合优化问题的一个最优解</p> <h2 id="用退火算法解决旅行商问题"><a href="#用退火算法解决旅行商问题" class="header-anchor">#</a> 用退火算法解决旅行商问题</h2> <h3 id="_1-原理"><a href="#_1-原理" class="header-anchor">#</a> 1. 原理</h3> <p>设有n个城市，城市间的距离用矩阵<code>D＝[dij](i,j=1,2,…,n)</code>表示，当问题对称时，有<code>dij＝dji</code>。</p> <ol><li><p>解空间,其空间规模为<code>(n-1)!</code></p></li> <li><p>指标函数</p> <p></p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-i"><mjx-c c="f"></mjx-c></mjx-mi><mjx-mrow><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c="2026"></mjx-c></mjx-mo><mjx-mo space="2" class="mjx-n"><mjx-c c=","></mjx-c></mjx-mo><mjx-msub space="2"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-munderover space="4"><mjx-over style="padding-bottom:0.192em;padding-left:0.51em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="n"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-over><mjx-box><mjx-munder><mjx-row><mjx-base><mjx-mo class="mjx-lop"><mjx-c c="2211"></mjx-c></mjx-mo></mjx-base></mjx-row><mjx-row><mjx-under style="padding-top:0.167em;padding-left:0.148em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-under></mjx-row></mjx-munder></mjx-box></mjx-munderover><mjx-mi space="2" class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="i"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub></mjx-math></mjx-container></p><p></p></li> <li><p>新解的产生，采用两个城市间的逆序交换方式得到问题的一个新解。</p></li> <li><p>指标函数差:</p> <p></p><p><mjx-container jax="CHTML" display="true" class="MathJax"><mjx-math display="true" class=" MJX-TEX"><mjx-mi class="mjx-n"><mjx-c c="394"></mjx-c></mjx-mi><mjx-mi class="mjx-i"><mjx-c c="f"></mjx-c></mjx-mi><mjx-mo space="4" class="mjx-n"><mjx-c c="="></mjx-c></mjx-mo><mjx-mrow space="4"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="v"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="v"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow><mjx-mo space="3" class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mrow space="3"><mjx-mo class="mjx-n"><mjx-c c="("></mjx-c></mjx-mo><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="u"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo space="3" class="mjx-n"><mjx-c c="+"></mjx-c></mjx-mo><mjx-msub space="3"><mjx-mi noIC="true" class="mjx-i"><mjx-c c="d"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="v"></mjx-c></mjx-mi><mjx-mo class="mjx-n"><mjx-c c="2212"></mjx-c></mjx-mo><mjx-mn class="mjx-n"><mjx-c c="1"></mjx-c></mjx-mn></mjx-TeXAtom></mjx-script></mjx-msub><mjx-msub><mjx-mi noIC="true" class="mjx-i"><mjx-c c="3C0"></mjx-c></mjx-mi><mjx-script style="vertical-align:-0.15em;"><mjx-TeXAtom size="s"><mjx-mi class="mjx-i"><mjx-c c="v"></mjx-c></mjx-mi></mjx-TeXAtom></mjx-script></mjx-msub></mjx-TeXAtom></mjx-script></mjx-msub><mjx-mo class="mjx-n"><mjx-c c=")"></mjx-c></mjx-mo></mjx-mrow></mjx-math></mjx-container></p><p></p></li> <li><p>新解的接受准则:</p> <p></p><p>A_{t}=\left\{\begin{array}{cc}
 1 &amp; ; \Delta f&lt;0 \\
 e^{-\frac{\Delta f}{t}} &amp; ; \text {other}
 \end{array}\right.</p><p></p> <p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/blog/20200323/wJQKqmdWLHAz.png" alt="mark"></p></li></ol> <h3 id="_2-网上的办法"><a href="#_2-网上的办法" class="header-anchor">#</a> 2. 网上的办法</h3> <p>设置初始温度，停止温度与降温系数
tmp = 1e5
tmp_min = 1e-3
alpha = 0.98</p> <p>直到 tmp &lt; tmp_min 的时候停止，产生新解的办法是交换两个城市的顺序。</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
Created on Mon Mar 23 21:38:00 2020

@author: Rical
&quot;&quot;&quot;</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt

len_plot <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

city_map <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">[</span>   <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">2538.94</span> <span class="token punctuation">,</span> <span class="token number">2873.8</span>  <span class="token punctuation">,</span> <span class="token number">2575.27</span> <span class="token punctuation">,</span> <span class="token number">2318.1</span>  <span class="token punctuation">,</span> <span class="token number">2158.71</span> <span class="token punctuation">,</span> <span class="token number">2216.58</span> <span class="token punctuation">,</span> <span class="token number">3174.04</span> <span class="token punctuation">,</span> <span class="token number">3371.13</span> <span class="token punctuation">,</span> <span class="token number">3540.24</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2538.94</span> <span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1073.54</span> <span class="token punctuation">,</span>  <span class="token number">111.288</span><span class="token punctuation">,</span>  <span class="token number">266.835</span><span class="token punctuation">,</span>  <span class="token number">395.032</span><span class="token punctuation">,</span>  <span class="token number">410.118</span><span class="token punctuation">,</span>  <span class="token number">637.942</span><span class="token punctuation">,</span>  <span class="token number">853.554</span><span class="token punctuation">,</span> <span class="token number">1055</span><span class="token punctuation">.</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2873.8</span>  <span class="token punctuation">,</span> <span class="token number">1073.54</span> <span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">964.495</span><span class="token punctuation">,</span>  <span class="token number">988.636</span><span class="token punctuation">,</span> <span class="token number">1094.32</span> <span class="token punctuation">,</span> <span class="token number">1382.73</span> <span class="token punctuation">,</span> <span class="token number">1240.15</span> <span class="token punctuation">,</span> <span class="token number">1460.25</span> <span class="token punctuation">,</span> <span class="token number">1687</span><span class="token punctuation">.</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2575.27</span> <span class="token punctuation">,</span>  <span class="token number">111.288</span><span class="token punctuation">,</span>  <span class="token number">964.495</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">262.053</span><span class="token punctuation">,</span>  <span class="token number">416.707</span><span class="token punctuation">,</span>  <span class="token number">503.563</span><span class="token punctuation">,</span>  <span class="token number">624.725</span><span class="token punctuation">,</span>  <span class="token number">854.916</span><span class="token punctuation">,</span> <span class="token number">1068.42</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2318.1</span>  <span class="token punctuation">,</span>  <span class="token number">266.835</span><span class="token punctuation">,</span>  <span class="token number">988.636</span><span class="token punctuation">,</span>  <span class="token number">262.053</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">163.355</span><span class="token punctuation">,</span>  <span class="token number">395.14</span> <span class="token punctuation">,</span>  <span class="token number">885</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1110.86</span> <span class="token punctuation">,</span> <span class="token number">1318.19</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2158.71</span> <span class="token punctuation">,</span>  <span class="token number">395.032</span><span class="token punctuation">,</span> <span class="token number">1094.32</span> <span class="token punctuation">,</span>  <span class="token number">416.707</span><span class="token punctuation">,</span>  <span class="token number">163.355</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">338.634</span><span class="token punctuation">,</span> <span class="token number">1030.34</span> <span class="token punctuation">,</span> <span class="token number">1248.58</span> <span class="token punctuation">,</span> <span class="token number">1447.69</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2216.58</span> <span class="token punctuation">,</span>  <span class="token number">410.118</span><span class="token punctuation">,</span> <span class="token number">1382.73</span> <span class="token punctuation">,</span>  <span class="token number">503.563</span><span class="token punctuation">,</span>  <span class="token number">395.14</span> <span class="token punctuation">,</span>  <span class="token number">338.634</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">984.068</span><span class="token punctuation">,</span> <span class="token number">1160.26</span> <span class="token punctuation">,</span> <span class="token number">1323.7</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3174.04</span> <span class="token punctuation">,</span>  <span class="token number">637.942</span><span class="token punctuation">,</span> <span class="token number">1240.15</span> <span class="token punctuation">,</span>  <span class="token number">624.725</span><span class="token punctuation">,</span>  <span class="token number">885</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1030.34</span> <span class="token punctuation">,</span>  <span class="token number">984.068</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">243.417</span><span class="token punctuation">,</span>  <span class="token number">473.768</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3371.13</span> <span class="token punctuation">,</span>  <span class="token number">853.554</span><span class="token punctuation">,</span> <span class="token number">1460.25</span> <span class="token punctuation">,</span>  <span class="token number">854.916</span><span class="token punctuation">,</span> <span class="token number">1110.86</span> <span class="token punctuation">,</span> <span class="token number">1248.58</span> <span class="token punctuation">,</span> <span class="token number">1160.26</span> <span class="token punctuation">,</span>  <span class="token number">243.417</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">232.112</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3540.24</span> <span class="token punctuation">,</span> <span class="token number">1055</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1687</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1068.42</span> <span class="token punctuation">,</span> <span class="token number">1318.19</span> <span class="token punctuation">,</span> <span class="token number">1447.69</span> <span class="token punctuation">,</span> <span class="token number">1323.7</span>  <span class="token punctuation">,</span>  <span class="token number">473.768</span><span class="token punctuation">,</span>  <span class="token number">232.112</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'float'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">calc_len</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># best = 8916</span>
    length <span class="token operator">=</span> city_map<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> path<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> city_map<span class="token punctuation">[</span>path<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  
        length <span class="token operator">+=</span> city_map<span class="token punctuation">[</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token keyword">return</span> length

<span class="token keyword">def</span> <span class="token function">get_2_randint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> j <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> i <span class="token operator">==</span> j<span class="token punctuation">:</span>
        i<span class="token punctuation">,</span> j <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> i<span class="token punctuation">,</span> j

<span class="token keyword">def</span> <span class="token function">judge</span><span class="token punctuation">(</span>dE<span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> dE <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>dE <span class="token operator">/</span> tmp<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> d <span class="token operator">&gt;</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 初始温度，停止温度与降温系数</span>
    tmp <span class="token operator">=</span> <span class="token number">100</span>
    tmp_min <span class="token operator">=</span> <span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span>
    alpha <span class="token operator">=</span> <span class="token number">0.98</span>
    <span class="token comment"># 从 0 出发回到 0</span>
    TSP_path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
    ori_len <span class="token operator">=</span> calc_len<span class="token punctuation">(</span>TSP_path<span class="token punctuation">)</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> tmp <span class="token operator">&lt;</span> tmp_min<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'End Normal!'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        i<span class="token punctuation">,</span> j <span class="token operator">=</span> get_2_randint<span class="token punctuation">(</span><span class="token punctuation">)</span>
        TSP_path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> TSP_path<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> TSP_path<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> TSP_path<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        new_len <span class="token operator">=</span> calc_len<span class="token punctuation">(</span>TSP_path<span class="token punctuation">)</span>
        dE <span class="token operator">=</span> new_len <span class="token operator">-</span> ori_len
        <span class="token keyword">if</span> judge<span class="token punctuation">(</span>dE<span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Length: {:.3f}, path: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>new_len<span class="token punctuation">,</span> TSP_path<span class="token punctuation">)</span><span class="token punctuation">)</span>
            len_plot<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_len<span class="token punctuation">)</span>
            ori_len <span class="token operator">=</span> new_len
            tmp <span class="token operator">=</span> tmp <span class="token operator">*</span> alpha
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            TSP_path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> TSP_path<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> TSP_path<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> TSP_path<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>len_plot<span class="token punctuation">)</span>
main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>运行结果：</p> <p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/blog/20200324/O7ResxCjIC44.png" alt="mark"></p> <h3 id="_3-老师教的方法"><a href="#_3-老师教的方法" class="header-anchor">#</a> 3. 老师教的方法</h3> <p><strong>初始温度</strong> t0＝280</p> <p>在每个温度下采用<strong>固定迭代次数</strong> Lk＝100n，n为城市数</p> <p><strong>温度衰减系数</strong>a＝0.92，即tk＋1＝0.92×tk</p> <p><strong>算法终止准则</strong>为当相邻两个温度得到的解无任何变化时算法停止。</p> <p>代码如下：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token triple-quoted-string string">&quot;&quot;&quot;
Created on Mon Mar 23 21:38:00 2020

@author: Rical
&quot;&quot;&quot;</span>

<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
len_plot <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

n <span class="token operator">=</span> <span class="token number">10</span>

<span class="token keyword">def</span> <span class="token function">calc_len</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> cmap<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># best = 8916</span>
    length <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        length <span class="token operator">+=</span> cmap<span class="token punctuation">[</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
    len_plot<span class="token punctuation">.</span>append<span class="token punctuation">(</span>length<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Length: {:.3f}, path: {}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> length

<span class="token keyword">def</span> <span class="token function">get_2_randint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    i <span class="token operator">=</span> j <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token comment"># 为了确保 i 比 j 小，且 i 与 j 之间至少相隔两个元素</span>
    <span class="token keyword">while</span> i <span class="token operator">&gt;=</span> j <span class="token operator">-</span> <span class="token number">2</span> <span class="token keyword">or</span> j <span class="token operator">-</span> i <span class="token operator">==</span> <span class="token number">10</span><span class="token punctuation">:</span>
        i<span class="token punctuation">,</span> j <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> i<span class="token punctuation">,</span> j

<span class="token keyword">def</span> <span class="token function">judge</span><span class="token punctuation">(</span>dE<span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> dE <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> np<span class="token punctuation">.</span>exp<span class="token punctuation">(</span><span class="token operator">-</span><span class="token punctuation">(</span>dE <span class="token operator">/</span> tmp<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> d <span class="token operator">&gt;</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 生成地图</span>
    cmap <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">[</span>   <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">2538.94</span> <span class="token punctuation">,</span> <span class="token number">2873.8</span>  <span class="token punctuation">,</span> <span class="token number">2575.27</span> <span class="token punctuation">,</span> <span class="token number">2318.1</span>  <span class="token punctuation">,</span> <span class="token number">2158.71</span> <span class="token punctuation">,</span> <span class="token number">2216.58</span> <span class="token punctuation">,</span> <span class="token number">3174.04</span> <span class="token punctuation">,</span> <span class="token number">3371.13</span> <span class="token punctuation">,</span> <span class="token number">3540.24</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2538.94</span> <span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1073.54</span> <span class="token punctuation">,</span>  <span class="token number">111.288</span><span class="token punctuation">,</span>  <span class="token number">266.835</span><span class="token punctuation">,</span>  <span class="token number">395.032</span><span class="token punctuation">,</span>  <span class="token number">410.118</span><span class="token punctuation">,</span>  <span class="token number">637.942</span><span class="token punctuation">,</span>  <span class="token number">853.554</span><span class="token punctuation">,</span> <span class="token number">1055</span><span class="token punctuation">.</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2873.8</span>  <span class="token punctuation">,</span> <span class="token number">1073.54</span> <span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">964.495</span><span class="token punctuation">,</span>  <span class="token number">988.636</span><span class="token punctuation">,</span> <span class="token number">1094.32</span> <span class="token punctuation">,</span> <span class="token number">1382.73</span> <span class="token punctuation">,</span> <span class="token number">1240.15</span> <span class="token punctuation">,</span> <span class="token number">1460.25</span> <span class="token punctuation">,</span> <span class="token number">1687</span><span class="token punctuation">.</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2575.27</span> <span class="token punctuation">,</span>  <span class="token number">111.288</span><span class="token punctuation">,</span>  <span class="token number">964.495</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">262.053</span><span class="token punctuation">,</span>  <span class="token number">416.707</span><span class="token punctuation">,</span>  <span class="token number">503.563</span><span class="token punctuation">,</span>  <span class="token number">624.725</span><span class="token punctuation">,</span>  <span class="token number">854.916</span><span class="token punctuation">,</span> <span class="token number">1068.42</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2318.1</span>  <span class="token punctuation">,</span>  <span class="token number">266.835</span><span class="token punctuation">,</span>  <span class="token number">988.636</span><span class="token punctuation">,</span>  <span class="token number">262.053</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">163.355</span><span class="token punctuation">,</span>  <span class="token number">395.14</span> <span class="token punctuation">,</span>  <span class="token number">885</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1110.86</span> <span class="token punctuation">,</span> <span class="token number">1318.19</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2158.71</span> <span class="token punctuation">,</span>  <span class="token number">395.032</span><span class="token punctuation">,</span> <span class="token number">1094.32</span> <span class="token punctuation">,</span>  <span class="token number">416.707</span><span class="token punctuation">,</span>  <span class="token number">163.355</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">338.634</span><span class="token punctuation">,</span> <span class="token number">1030.34</span> <span class="token punctuation">,</span> <span class="token number">1248.58</span> <span class="token punctuation">,</span> <span class="token number">1447.69</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">2216.58</span> <span class="token punctuation">,</span>  <span class="token number">410.118</span><span class="token punctuation">,</span> <span class="token number">1382.73</span> <span class="token punctuation">,</span>  <span class="token number">503.563</span><span class="token punctuation">,</span>  <span class="token number">395.14</span> <span class="token punctuation">,</span>  <span class="token number">338.634</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">984.068</span><span class="token punctuation">,</span> <span class="token number">1160.26</span> <span class="token punctuation">,</span> <span class="token number">1323.7</span>  <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3174.04</span> <span class="token punctuation">,</span>  <span class="token number">637.942</span><span class="token punctuation">,</span> <span class="token number">1240.15</span> <span class="token punctuation">,</span>  <span class="token number">624.725</span><span class="token punctuation">,</span>  <span class="token number">885</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1030.34</span> <span class="token punctuation">,</span>  <span class="token number">984.068</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">243.417</span><span class="token punctuation">,</span>  <span class="token number">473.768</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3371.13</span> <span class="token punctuation">,</span>  <span class="token number">853.554</span><span class="token punctuation">,</span> <span class="token number">1460.25</span> <span class="token punctuation">,</span>  <span class="token number">854.916</span><span class="token punctuation">,</span> <span class="token number">1110.86</span> <span class="token punctuation">,</span> <span class="token number">1248.58</span> <span class="token punctuation">,</span> <span class="token number">1160.26</span> <span class="token punctuation">,</span>  <span class="token number">243.417</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span>  <span class="token number">232.112</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token punctuation">[</span><span class="token number">3540.24</span> <span class="token punctuation">,</span> <span class="token number">1055</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1687</span><span class="token punctuation">.</span>   <span class="token punctuation">,</span> <span class="token number">1068.42</span> <span class="token punctuation">,</span> <span class="token number">1318.19</span> <span class="token punctuation">,</span> <span class="token number">1447.69</span> <span class="token punctuation">,</span> <span class="token number">1323.7</span>  <span class="token punctuation">,</span>  <span class="token number">473.768</span><span class="token punctuation">,</span>  <span class="token number">232.112</span><span class="token punctuation">,</span>    <span class="token number">0</span><span class="token punctuation">.</span>   <span class="token punctuation">]</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'float'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment"># 康立山</span>
    tmp <span class="token operator">=</span> <span class="token number">280</span>
    alpha <span class="token operator">=</span> <span class="token number">0.92</span>
    path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span>
    count <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span> <span class="token operator">*</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        count <span class="token operator">+=</span> <span class="token number">1</span>
        i<span class="token punctuation">,</span> j <span class="token operator">=</span> get_2_randint<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># 只更换 i，j 中间部分，不包含 i j</span>
        dE <span class="token operator">=</span> cmap<span class="token punctuation">[</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+</span> cmap<span class="token punctuation">[</span>path<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> cmap<span class="token punctuation">[</span>path<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">-</span> cmap<span class="token punctuation">[</span>path<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> path<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">]</span>
        <span class="token keyword">if</span> dE <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            calc_len<span class="token punctuation">(</span>path<span class="token punctuation">,</span> cmap<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">,</span> i<span class="token punctuation">,</span> j<span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token keyword">if</span> judge<span class="token punctuation">(</span>dE<span class="token punctuation">,</span> tmp<span class="token punctuation">)</span><span class="token punctuation">:</span>
            path<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> path<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">:</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            calc_len<span class="token punctuation">(</span>path<span class="token punctuation">,</span> cmap<span class="token punctuation">)</span>
            tmp <span class="token operator">=</span> tmp <span class="token operator">*</span> alpha
    <span class="token keyword">print</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>len_plot<span class="token punctuation">)</span>
main<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>运行结果：</p> <p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/blog/20200323/r6Tz7dFqdInX.png" alt="mark"></p> <h2 id="参考资料"><a href="#参考资料" class="header-anchor">#</a> 参考资料</h2> <p>[1] <a href="https://www.cnblogs.com/haimishasha/p/9795592.html" target="_blank" rel="noopener noreferrer">优化算法系列-模拟退火算法（1）——基本原理枯燥版本<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">修改于:</span> <span class="time">8/30/2020, 4:06:23 PM</span></div></footer> <!----> <div data-v-7cfe0aba><section class="page-edit" data-v-7cfe0aba><div id="vcomments" data-v-7cfe0aba></div></section></div></div> <div class="my-main-right"><div style="font-size:14px"><a href="https://me.csdn.net/jaykm" target="_blank">CSDN</a>    
        <a href="https://github.com/Yiyuery" target="_blank">GitHub</a>   
        <a href="https://juejin.im/user/5c17f022f265da616c65862f" target="_blank">掘金</a>   
        <a href="mailto:xiazhaoyang@live.com">邮件</a></div> <div class="my-menu"><h4 style="margin-top: 0;">目录</h4> <a href="/Simulated-annealing-algorithm/#固体退火过程" class="my-menu__lv2">固体退火过程</a><a href="/Simulated-annealing-algorithm/#模拟退火算法" class="my-menu__lv2">模拟退火算法</a><a href="/Simulated-annealing-algorithm/#用退火算法解决旅行商问题" class="my-menu__lv2">用退火算法解决旅行商问题</a><a href="/Simulated-annealing-algorithm/#_1-原理" class="my-menu__lv3">1. 原理</a><a href="/Simulated-annealing-algorithm/#_2-网上的办法" class="my-menu__lv3">2. 网上的办法</a><a href="/Simulated-annealing-algorithm/#_3-老师教的方法" class="my-menu__lv3">3. 老师教的方法</a><a href="/Simulated-annealing-algorithm/#参考资料" class="my-menu__lv2">参考资料</a></div></div></div> </main></div> <div class="footer">
    © 2019-2020 ❤️ Yiyuery<br> <a href="http://www.beian.miit.gov.cn" target="_blank">皖 ICP 备 19016269 号</a><br> <a href="https://me.csdn.net/jaykm" target="_blank">CSDN</a>    
    <a href="https://github.com/Xerrors" target="_blank">GitHub</a>   
    <a href="https://juejin.im/user/5c17f022f265da616c65862f" target="_blank">掘金</a><br> <a href="mailto:xiazhaoyang@live.com">发送邮件</a></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.839ced15.js" defer></script><script src="/assets/js/4.3fbc1f96.js" defer></script><script src="/assets/js/20.979ad63c.js" defer></script>
  </body>
</html>
