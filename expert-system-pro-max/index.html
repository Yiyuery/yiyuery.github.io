<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>动物专家系统「续」拓扑序列 | Yiyuery</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/favicon.ico">
    <meta name="description" content="Yiyuery's 个人博客">
    <link rel="preload" href="/assets/css/0.styles.fac40609.css" as="style"><link rel="preload" href="/assets/js/app.839ced15.js" as="script"><link rel="preload" href="/assets/js/4.3fbc1f96.js" as="script"><link rel="preload" href="/assets/js/9.c85ef583.js" as="script"><link rel="prefetch" href="/assets/js/1.43a347b2.js"><link rel="prefetch" href="/assets/js/10.9753ee5d.js"><link rel="prefetch" href="/assets/js/11.96c59566.js"><link rel="prefetch" href="/assets/js/12.2c50efec.js"><link rel="prefetch" href="/assets/js/13.5d6e55a8.js"><link rel="prefetch" href="/assets/js/14.fc442e96.js"><link rel="prefetch" href="/assets/js/15.24339c79.js"><link rel="prefetch" href="/assets/js/16.1587d289.js"><link rel="prefetch" href="/assets/js/17.44142bfd.js"><link rel="prefetch" href="/assets/js/18.994bb200.js"><link rel="prefetch" href="/assets/js/19.ca759cda.js"><link rel="prefetch" href="/assets/js/2.52d476cc.js"><link rel="prefetch" href="/assets/js/20.979ad63c.js"><link rel="prefetch" href="/assets/js/21.fecc9d80.js"><link rel="prefetch" href="/assets/js/22.3e99d924.js"><link rel="prefetch" href="/assets/js/23.951d9b97.js"><link rel="prefetch" href="/assets/js/24.bad04352.js"><link rel="prefetch" href="/assets/js/25.ce195067.js"><link rel="prefetch" href="/assets/js/26.7b3581a7.js"><link rel="prefetch" href="/assets/js/27.efc77ae3.js"><link rel="prefetch" href="/assets/js/28.16eb2f91.js"><link rel="prefetch" href="/assets/js/29.7772d15e.js"><link rel="prefetch" href="/assets/js/30.3870d4d1.js"><link rel="prefetch" href="/assets/js/31.0f4cfbf5.js"><link rel="prefetch" href="/assets/js/32.29d81c04.js"><link rel="prefetch" href="/assets/js/33.28affd1f.js"><link rel="prefetch" href="/assets/js/34.d28c7114.js"><link rel="prefetch" href="/assets/js/35.d7bb0604.js"><link rel="prefetch" href="/assets/js/36.ebab3576.js"><link rel="prefetch" href="/assets/js/37.0eb5a00d.js"><link rel="prefetch" href="/assets/js/38.9db427c3.js"><link rel="prefetch" href="/assets/js/39.53ecfed9.js"><link rel="prefetch" href="/assets/js/40.b2df18d9.js"><link rel="prefetch" href="/assets/js/41.b6970575.js"><link rel="prefetch" href="/assets/js/42.5d438713.js"><link rel="prefetch" href="/assets/js/43.0f984b43.js"><link rel="prefetch" href="/assets/js/44.4a9567c2.js"><link rel="prefetch" href="/assets/js/45.e77b2e3a.js"><link rel="prefetch" href="/assets/js/46.db689d82.js"><link rel="prefetch" href="/assets/js/47.ca290c98.js"><link rel="prefetch" href="/assets/js/48.cc29300b.js"><link rel="prefetch" href="/assets/js/49.f43fa070.js"><link rel="prefetch" href="/assets/js/5.8663838d.js"><link rel="prefetch" href="/assets/js/50.5ac4404a.js"><link rel="prefetch" href="/assets/js/51.20121ae0.js"><link rel="prefetch" href="/assets/js/52.d225ba88.js"><link rel="prefetch" href="/assets/js/53.adeb5a3a.js"><link rel="prefetch" href="/assets/js/54.a4dc7855.js"><link rel="prefetch" href="/assets/js/55.4b88ddc7.js"><link rel="prefetch" href="/assets/js/56.a13331f5.js"><link rel="prefetch" href="/assets/js/57.885d087b.js"><link rel="prefetch" href="/assets/js/58.a3064fd9.js"><link rel="prefetch" href="/assets/js/59.7e0d1f6e.js"><link rel="prefetch" href="/assets/js/6.83d9063b.js"><link rel="prefetch" href="/assets/js/60.33d66471.js"><link rel="prefetch" href="/assets/js/61.d332eaa5.js"><link rel="prefetch" href="/assets/js/62.8eaf5a15.js"><link rel="prefetch" href="/assets/js/63.6e0c7f61.js"><link rel="prefetch" href="/assets/js/64.17534d3f.js"><link rel="prefetch" href="/assets/js/65.40d814d7.js"><link rel="prefetch" href="/assets/js/66.9279a738.js"><link rel="prefetch" href="/assets/js/67.5cdb9fd6.js"><link rel="prefetch" href="/assets/js/68.26c5c99d.js"><link rel="prefetch" href="/assets/js/69.d349f923.js"><link rel="prefetch" href="/assets/js/7.6cb83fee.js"><link rel="prefetch" href="/assets/js/8.d6104416.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fac40609.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><!----> <div id="my-bg"></div> <header class="navbar my-nav"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logoko.png" alt="Yiyuery" class="logo"> <span class="site-name can-hide">Yiyuery</span></a> <div class="links"><div class="color-picker"><a class="color-button">
		切换
	</a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">切换主题</h4> <ul class="color-mode-options"><li class="dark">暗</li><li class="auto active">自动</li><li class="light">亮</li></ul></div></div></div> <!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">📃 文章</a></div><div class="nav-item"><a href="/zhuanlan/" class="nav-link">📰 专栏</a></div><div class="nav-item"><a href="/zone/" class="nav-link">🤪 动态</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">🔨 工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">🚥 导航</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">🔗 友链</a></li></ul></div></div> <!----></nav> <a href="https://github.com/Yiyuery/" target="_blank" class="can-hide" style="display: flex; align-items: center; margin-left: 10px;"><img src="/github.png" class="my-svg" style="width: 1.4rem; height: 1.4rem;"></a></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">📃 文章</a></div><div class="nav-item"><a href="/zhuanlan/" class="nav-link">📰 专栏</a></div><div class="nav-item"><a href="/zone/" class="nav-link">🤪 动态</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">🔨 工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">🚥 导航</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">🔗 友链</a></li></ul></div></div> <!----></nav>  <!----> </aside> <div><main class="page need-zoom"> <div class="my-main"><div class="my-main-left"><div class="my-title-box"><h2>动物专家系统「续」拓扑序列</h2> <div class="my-title-info"><span id="/expert-system-pro-max/" data-flag-title="动物专家系统「续」拓扑序列" class="leancloud-visitors"><span>作者：玉川</span>  
            <span>2020 年 5 月 21 日  </span> <i class="el-icon-view" style="margin-right: 3px;"></i> <span class="leancloud-visitors-count"></span></span></div></div> <div class="theme-default-content content__default" data-v-c730c506 data-v-c730c506><div data-v-c730c506><h2 data-v-c730c506>概念</h2> <div class="item-box" data-v-c730c506><div class="inactive" data-v-c730c506> 有毛<br data-v-c730c506>( 0 )
            </div><div class="inactive" data-v-c730c506> 产奶<br data-v-c730c506>( 1 )
            </div><div class="inactive" data-v-c730c506> 有羽毛<br data-v-c730c506>( 2 )
            </div><div class="inactive" data-v-c730c506> 会飞<br data-v-c730c506>( 3 )
            </div><div class="inactive" data-v-c730c506> 会下蛋<br data-v-c730c506>( 4 )
            </div><div class="inactive" data-v-c730c506> 吃肉<br data-v-c730c506>( 5 )
            </div><div class="inactive" data-v-c730c506> 有犬齿<br data-v-c730c506>( 6 )
            </div><div class="inactive" data-v-c730c506> 有爪<br data-v-c730c506>( 7 )
            </div><div class="inactive" data-v-c730c506> 眼睛盯前方<br data-v-c730c506>( 8 )
            </div><div class="inactive" data-v-c730c506> 有蹄<br data-v-c730c506>( 9 )
            </div><div class="inactive" data-v-c730c506> 反刍<br data-v-c730c506>( 10 )
            </div><div class="inactive" data-v-c730c506> 黄褐色<br data-v-c730c506>( 11 )
            </div><div class="inactive" data-v-c730c506> 有斑点<br data-v-c730c506>( 12 )
            </div><div class="inactive" data-v-c730c506> 有黑色条纹<br data-v-c730c506>( 13 )
            </div><div class="inactive" data-v-c730c506> 长脖<br data-v-c730c506>( 14 )
            </div><div class="inactive" data-v-c730c506> 长腿<br data-v-c730c506>( 15 )
            </div><div class="inactive" data-v-c730c506> 不会飞<br data-v-c730c506>( 16 )
            </div><div class="inactive" data-v-c730c506> 会游泳<br data-v-c730c506>( 17 )
            </div><div class="inactive" data-v-c730c506> 黑白两色<br data-v-c730c506>( 18 )
            </div><div class="inactive" data-v-c730c506> 善飞<br data-v-c730c506>( 19 )
            </div><div class="inactive" data-v-c730c506> 哺乳类<br data-v-c730c506>( 20 )
            </div><div class="inactive" data-v-c730c506> 鸟类<br data-v-c730c506>( 21 )
            </div><div class="inactive" data-v-c730c506> 肉食类<br data-v-c730c506>( 22 )
            </div><div class="inactive" data-v-c730c506> 蹄类<br data-v-c730c506>( 23 )
            </div><div class="inactive" data-v-c730c506> 企鹅<br data-v-c730c506>( 24 )
            </div><div class="inactive" data-v-c730c506> 海燕<br data-v-c730c506>( 25 )
            </div><div class="inactive" data-v-c730c506> 鸵鸟<br data-v-c730c506>( 26 )
            </div><div class="inactive" data-v-c730c506> 斑马<br data-v-c730c506>( 27 )
            </div><div class="inactive" data-v-c730c506> 长颈鹿<br data-v-c730c506>( 28 )
            </div><div class="inactive" data-v-c730c506> 虎<br data-v-c730c506>( 29 )
            </div><div class="inactive" data-v-c730c506> 金钱豹<br data-v-c730c506>( 30 )
            </div> <div class="inactive" data-v-c730c506>添加<br data-v-c730c506>概念</div></div> <div class="el-input el-input-group el-input-group--append" style="width:90%;padding:10px;" data-v-c730c506><!----><input type="text" autocomplete="off" placeholder="1,3&gt;10" class="el-input__inner"><!----><!----><div class="el-input-group__append"><button type="button" class="el-button el-button--default" data-v-c730c506><!----><!----><span>添加规则</span></button></div><!----></div> <button type="button" class="el-button el-button--default" style="width:90%;margin:10px;" data-v-c730c506><!----><!----><span>重新选择</span></button> <h2 data-v-c730c506>过程</h2> </div> <p data-v-c730c506><a href="https://www.xerrors.fun/Animal-Identification-Expert-System/" target="_blank" rel="noopener noreferrer" data-v-c730c506>上一篇文章<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-c730c506 data-v-c730c506><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 已经实现了「动物专家系统」的基本功能。其实已经是我的改进版本了，所以上一版的名称是 ExpertSystemPro，那么现在来了第三版，就叫 ExpertSystemProMax 吧！</p> <p data-v-c730c506>在线可编辑演示地址，整个项目的源码也可以在 Codepen 里面看到：</p> <ul data-v-c730c506><li data-v-c730c506><a href="https://codepen.io/xerrors/pen/RwWydzQ" target="_blank" rel="noopener noreferrer" data-v-c730c506>ExpertSystem 中杯<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-c730c506 data-v-c730c506><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li data-v-c730c506><a href="https://codepen.io/xerrors/pen/abvGeqy" target="_blank" rel="noopener noreferrer" data-v-c730c506>ExpertSystemPro 大杯<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-c730c506 data-v-c730c506><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li data-v-c730c506><a href="https://codepen.io/xerrors/pen/oNjaaWG?editors=0010" target="_blank" rel="noopener noreferrer" data-v-c730c506>ExpertSystemProMax 超大杯<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-c730c506 data-v-c730c506><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p data-v-c730c506>当然直接在我的个人博客网站里面就可以演示：<a href="https://www.xerrors.fun/blog/" target="_blank" rel="noopener noreferrer" data-v-c730c506>https://www.xerrors.fun/blog/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound" data-v-c730c506 data-v-c730c506><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p data-v-c730c506>接下来考虑用户可以<strong data-v-c730c506>自行添加概念以及规则</strong>的情况，前面我们已经了解到，想要正常的进行推理就必须要满足拓扑序列，否则就需要多次遍历才行。</p> <h2 id="_1-添加新的规则" data-v-c730c506><a href="#_1-添加新的规则" class="header-anchor" data-v-c730c506>#</a> 1. 添加新的规则</h2> <p data-v-c730c506>这里主要把实现的时候的难点说一下，即使读者可能不是使用 JavaScript 语言来写算法的，但是遇到的问题应该是一样的。对于如何实现插入新的规则应该有很多种做法，这里提供一个方法抛砖引玉；首先对用户的输入进行正则匹配，要求输入的格式为<code data-v-c730c506>1,3&gt;10</code>，表示由事实 1 和 3 可以推导出事实 10 成立。</p> <div class="language-js extra-class" data-v-c730c506><pre class="language-js" data-v-c730c506><code data-v-c730c506><span class="token comment" data-v-c730c506>// 对输入进行正则匹配</span>
<span class="token keyword" data-v-c730c506>const</span> pattern <span class="token operator" data-v-c730c506>=</span> <span class="token regex" data-v-c730c506>/^[0-9]+(,[0-9]*)*&gt;[0-9]+$/</span>
<span class="token keyword" data-v-c730c506>if</span> <span class="token punctuation" data-v-c730c506>(</span><span class="token operator" data-v-c730c506>!</span>pattern<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>test</span><span class="token punctuation" data-v-c730c506>(</span><span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>new_rule<span class="token punctuation" data-v-c730c506>)</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
    <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>$message<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>error</span><span class="token punctuation" data-v-c730c506>(</span><span class="token string" data-v-c730c506>'格式有误'</span><span class="token punctuation" data-v-c730c506>)</span>
    <span class="token keyword" data-v-c730c506>return</span>
<span class="token punctuation" data-v-c730c506>}</span>
</code></pre></div><p data-v-c730c506>之后的工作就是字符串处理了，各个语言的处理逻辑差不多：</p> <div class="language-js extra-class" data-v-c730c506><pre class="language-js" data-v-c730c506><code data-v-c730c506><span class="token comment" data-v-c730c506>// 对输入的字符串进行分割处理 1,3&gt;10 </span>
<span class="token keyword" data-v-c730c506>const</span> div <span class="token operator" data-v-c730c506>=</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>new_rule<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>indexOf</span><span class="token punctuation" data-v-c730c506>(</span><span class="token string" data-v-c730c506>'&gt;'</span><span class="token punctuation" data-v-c730c506>)</span>
<span class="token keyword" data-v-c730c506>const</span> conclusion <span class="token operator" data-v-c730c506>=</span> <span class="token function" data-v-c730c506>eval</span><span class="token punctuation" data-v-c730c506>(</span><span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>new_rule<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>slice</span><span class="token punctuation" data-v-c730c506>(</span>div<span class="token operator" data-v-c730c506>+</span><span class="token number" data-v-c730c506>1</span><span class="token punctuation" data-v-c730c506>)</span><span class="token punctuation" data-v-c730c506>)</span>
<span class="token keyword" data-v-c730c506>const</span> conditions <span class="token operator" data-v-c730c506>=</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>new_rule<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>slice</span><span class="token punctuation" data-v-c730c506>(</span><span class="token number" data-v-c730c506>0</span><span class="token punctuation" data-v-c730c506>,</span> div<span class="token punctuation" data-v-c730c506>)</span><span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>split</span><span class="token punctuation" data-v-c730c506>(</span><span class="token string" data-v-c730c506>','</span><span class="token punctuation" data-v-c730c506>)</span><span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>map</span><span class="token punctuation" data-v-c730c506>(</span><span class="token parameter" data-v-c730c506>item</span> <span class="token operator" data-v-c730c506>=&gt;</span> <span class="token function" data-v-c730c506>eval</span><span class="token punctuation" data-v-c730c506>(</span>item<span class="token punctuation" data-v-c730c506>)</span><span class="token punctuation" data-v-c730c506>)</span>
<span class="token comment" data-v-c730c506>// 对数据可行性进行判断</span>
<span class="token keyword" data-v-c730c506>if</span> <span class="token punctuation" data-v-c730c506>(</span>conclusion <span class="token operator" data-v-c730c506>&gt;=</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>features<span class="token punctuation" data-v-c730c506>.</span>length 
    <span class="token operator" data-v-c730c506>||</span> Math<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>max</span><span class="token punctuation" data-v-c730c506>(</span><span class="token operator" data-v-c730c506>...</span>conditions<span class="token punctuation" data-v-c730c506>)</span> <span class="token operator" data-v-c730c506>&gt;=</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>features<span class="token punctuation" data-v-c730c506>.</span>length<span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
    <span class="token keyword" data-v-c730c506>return</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>$message<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>error</span><span class="token punctuation" data-v-c730c506>(</span><span class="token string" data-v-c730c506>'超出范围'</span><span class="token punctuation" data-v-c730c506>)</span>
<span class="token punctuation" data-v-c730c506>}</span> <span class="token keyword" data-v-c730c506>else</span> <span class="token punctuation" data-v-c730c506>{</span>
    <span class="token keyword" data-v-c730c506>const</span> new_rule <span class="token operator" data-v-c730c506>=</span> <span class="token punctuation" data-v-c730c506>{</span>
        conditions<span class="token operator" data-v-c730c506>:</span> conditions<span class="token punctuation" data-v-c730c506>,</span>
        conclusion<span class="token operator" data-v-c730c506>:</span> conclusion
    <span class="token punctuation" data-v-c730c506>}</span><span class="token punctuation" data-v-c730c506>;</span>
    <span class="token comment" data-v-c730c506>// 插入一条新的规则</span>
    <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>rules <span class="token operator" data-v-c730c506>=</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>insertRule</span><span class="token punctuation" data-v-c730c506>(</span>new_rule<span class="token punctuation" data-v-c730c506>,</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>rules<span class="token punctuation" data-v-c730c506>)</span>
    <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>init</span><span class="token punctuation" data-v-c730c506>(</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token comment" data-v-c730c506>// 初始化 result 为空</span>
</code></pre></div><p data-v-c730c506>这里的插入函数 <code data-v-c730c506>this.insertRule(rule, rulesArray)</code>会在后面的篇幅着重介绍。</p> <h2 id="_2-对规则进行排序" data-v-c730c506><a href="#_2-对规则进行排序" class="header-anchor" data-v-c730c506>#</a> 2. 对规则进行排序</h2> <h3 id="多次遍历是否可行" data-v-c730c506><a href="#多次遍历是否可行" class="header-anchor" data-v-c730c506>#</a> 多次遍历是否可行</h3> <p data-v-c730c506>两次遍历为什么不可以？第一次遍历出来「中间结果」，第二次遍历出来「最终结果」。理想是好的，但是中间结果并不一定只有一层，一层中间结果可以使用两次遍历来解决，那么两层中间结果呢？</p> <p data-v-c730c506>比如下面这个例子，总共有 7 个「概念（事实）」，5 条「规则」，R1 - R5 按照从前到后的顺序排列，那么第一次遍历的时候，由于 R1、R2、R3 的条件都没有成立，只有 R4、R5 成立了，得到了推导结果  3 和 4；第二次顺序遍历的时候，由于 5 和 6 还没有被推导出来，所以 R1 依然不能成立，而由于 3 和 4 已经被推导出来，所以这次遍历之后 5 和 6 成立；那么当第三次遍历的时候，R1 才被推导出来。</p> <p data-v-c730c506><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/imgs/20200521000143.gif" alt="" data-v-c730c506></p> <p data-v-c730c506>这个例子说明，对于越复杂的规则程序要遍历的次数也就越多；而一般情况下我们难以估计遍历的次数，次数少了，不能保证「准确性」；次数多了搜索效率大大降低。所以我们应当对这个规则序列进行排序。</p> <h3 id="拓扑排序" data-v-c730c506><a href="#拓扑排序" class="header-anchor" data-v-c730c506>#</a> 拓扑排序</h3> <p data-v-c730c506>这里插一些对「拓扑排序」的解释，给不了解或者有些遗忘的同学复习；如下图所示，我们有两个规则：</p> <ul data-v-c730c506><li data-v-c730c506>R1：长脖子，且是食草动物，可得长颈鹿</li> <li data-v-c730c506>R2：吃草，且有蹄，可得食草动物</li></ul> <p data-v-c730c506>可以看到，这里规则 R1 的一个条件「食草动物」是 R2 的结论，所以在使用规则 R1 判断是不是「长颈鹿」的时候，必须要先使用规则 R2来判断是不是「食草动物」。那么经过排序把 R2 应该放在 R1 前面，得到的序列就是拓扑序列了。</p> <p data-v-c730c506><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/imgs/20200521002332.png" alt="" data-v-c730c506></p> <blockquote data-v-c730c506><p data-v-c730c506>我发现上一篇文章里面的手绘太丑了，我还是安安心心使用计算机画图吧！</p></blockquote> <p data-v-c730c506>那么问题来了？怎么得到「拓扑序列」呢？第一反应就是「拓扑排序」。但是仔细斟酌一下，发现事情并没有那么简单；在数据结构中所学习到的拓扑排序的 「AOV 网（顶点表示活动的网络）」中，顶点都是活动，这些顶点根据前驱和后继关系得到一个网；</p> <p data-v-c730c506>但是，在专家系统里面这些规则之间虽然存在前驱和后继关系，但是却没有直接的指针或者直接相连的数据结构（因为我们是使用数组来表示的），难以按照图的方式进行遍历；</p> <h3 id="插入排序" data-v-c730c506><a href="#插入排序" class="header-anchor" data-v-c730c506>#</a> 插入排序</h3> <p data-v-c730c506>总而言之，在对这些规则实现「拓扑排序」的时候是相当的麻烦的；那么我们就可以转换一下思路了，即没法使用「拓扑排序」，有要得到「拓扑序列」，即想要马儿跑，又不想让马儿吃草；其实我们可以使用「插入排序」的思想。</p> <p data-v-c730c506>当规则 A 的「结论」出现在规则 B 的「条件」中的时候，要把规则 A 放在规则 B 前面判断，其实也就是相当于 A「小于」B 咯，按照这个原理我们直接使用插入排序的思想对这个规则序列进行排序；</p> <p data-v-c730c506>工作流程：首先创建一个空的数组，然后依次对每一条规则执行插入操作；每一个要插入的规则 A 要从头进行遍历比较，当遍历到某个位置的规则 B 不再满足 A「小于」B 的时候，就把规则 A 插入到当前位置，否则就插入到数组的最后位置。</p> <p data-v-c730c506>看字可能不好理解，直接看代码（JavaScript），由于我们已经存在一个已知的拓扑序列，所以当添加规则的时候只需要执行一次插入操作就行；</p> <div class="language-js extra-class" data-v-c730c506><pre class="language-js" data-v-c730c506><code data-v-c730c506><span class="token comment" data-v-c730c506>// 对规则进行插入排序</span>
<span class="token function" data-v-c730c506>sortRules</span><span class="token punctuation" data-v-c730c506>(</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
  <span class="token keyword" data-v-c730c506>let</span> rulesArray <span class="token operator" data-v-c730c506>=</span> <span class="token punctuation" data-v-c730c506>[</span><span class="token punctuation" data-v-c730c506>]</span><span class="token punctuation" data-v-c730c506>;</span>
  <span class="token keyword" data-v-c730c506>for</span><span class="token punctuation" data-v-c730c506>(</span><span class="token keyword" data-v-c730c506>var</span> item <span class="token keyword" data-v-c730c506>of</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>rules<span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
    rulesArray <span class="token operator" data-v-c730c506>=</span> <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>insertRule</span><span class="token punctuation" data-v-c730c506>(</span>item<span class="token punctuation" data-v-c730c506>,</span> rulesArray<span class="token punctuation" data-v-c730c506>)</span><span class="token punctuation" data-v-c730c506>;</span>
  <span class="token punctuation" data-v-c730c506>}</span>
  console<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>log</span><span class="token punctuation" data-v-c730c506>(</span>rulesArray<span class="token punctuation" data-v-c730c506>)</span>
  <span class="token keyword" data-v-c730c506>return</span> rulesArray
<span class="token punctuation" data-v-c730c506>}</span><span class="token punctuation" data-v-c730c506>,</span>
<span class="token comment" data-v-c730c506>// 向已有的规则中插入一条新的规则</span>
<span class="token function" data-v-c730c506>insertRule</span><span class="token punctuation" data-v-c730c506>(</span><span class="token parameter" data-v-c730c506>rule<span class="token punctuation" data-v-c730c506>,</span> rulesArray</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
  <span class="token keyword" data-v-c730c506>if</span> <span class="token punctuation" data-v-c730c506>(</span>rulesArray <span class="token operator" data-v-c730c506>&amp;&amp;</span> rulesArray<span class="token punctuation" data-v-c730c506>.</span>length <span class="token operator" data-v-c730c506>===</span> <span class="token number" data-v-c730c506>0</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
    rulesArray<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>push</span><span class="token punctuation" data-v-c730c506>(</span>rule<span class="token punctuation" data-v-c730c506>)</span>
    <span class="token keyword" data-v-c730c506>return</span> rulesArray
  <span class="token punctuation" data-v-c730c506>}</span> <span class="token keyword" data-v-c730c506>else</span> <span class="token punctuation" data-v-c730c506>{</span>
    <span class="token keyword" data-v-c730c506>const</span> times <span class="token operator" data-v-c730c506>=</span> rulesArray<span class="token punctuation" data-v-c730c506>.</span>length
    <span class="token keyword" data-v-c730c506>for</span><span class="token punctuation" data-v-c730c506>(</span><span class="token keyword" data-v-c730c506>var</span> i <span class="token operator" data-v-c730c506>=</span> <span class="token number" data-v-c730c506>0</span><span class="token punctuation" data-v-c730c506>;</span> i <span class="token operator" data-v-c730c506>&lt;</span> times<span class="token punctuation" data-v-c730c506>;</span> i<span class="token operator" data-v-c730c506>++</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
      <span class="token comment" data-v-c730c506>// 如果该规则的推导结果会作为另外一个规则的条件的话，就放在那个规则的前面；</span>
      <span class="token comment" data-v-c730c506>// 否则放在最后一个；</span>
      <span class="token keyword" data-v-c730c506>if</span> <span class="token punctuation" data-v-c730c506>(</span>rulesArray<span class="token punctuation" data-v-c730c506>[</span>i<span class="token punctuation" data-v-c730c506>]</span><span class="token punctuation" data-v-c730c506>.</span>conditions<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>includes</span><span class="token punctuation" data-v-c730c506>(</span>rule<span class="token punctuation" data-v-c730c506>.</span>conclusion<span class="token punctuation" data-v-c730c506>)</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
        rulesArray<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>splice</span><span class="token punctuation" data-v-c730c506>(</span>i<span class="token punctuation" data-v-c730c506>,</span> <span class="token number" data-v-c730c506>0</span><span class="token punctuation" data-v-c730c506>,</span> rule<span class="token punctuation" data-v-c730c506>)</span>
        <span class="token keyword" data-v-c730c506>break</span>
      <span class="token punctuation" data-v-c730c506>}</span>
    <span class="token punctuation" data-v-c730c506>}</span>
    <span class="token keyword" data-v-c730c506>if</span><span class="token punctuation" data-v-c730c506>(</span>rulesArray<span class="token punctuation" data-v-c730c506>.</span>length <span class="token operator" data-v-c730c506>===</span> times<span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
      rulesArray<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>push</span><span class="token punctuation" data-v-c730c506>(</span>rule<span class="token punctuation" data-v-c730c506>)</span>
    <span class="token punctuation" data-v-c730c506>}</span>
    <span class="token keyword" data-v-c730c506>return</span> rulesArray
  <span class="token punctuation" data-v-c730c506>}</span>
<span class="token punctuation" data-v-c730c506>}</span>
</code></pre></div><h2 id="_3-添加新的概念" data-v-c730c506><a href="#_3-添加新的概念" class="header-anchor" data-v-c730c506>#</a> 3. 添加新的概念</h2> <p data-v-c730c506>这个难度很小：</p> <div class="language-js extra-class" data-v-c730c506><pre class="language-js" data-v-c730c506><code data-v-c730c506><span class="token function" data-v-c730c506>addConcept</span><span class="token punctuation" data-v-c730c506>(</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
    <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>$prompt</span><span class="token punctuation" data-v-c730c506>(</span><span class="token string" data-v-c730c506>'请输入名称（1-5字）'</span><span class="token punctuation" data-v-c730c506>,</span> <span class="token string" data-v-c730c506>'提示'</span><span class="token punctuation" data-v-c730c506>,</span> <span class="token punctuation" data-v-c730c506>{</span>
        confirmButtonText<span class="token operator" data-v-c730c506>:</span> <span class="token string" data-v-c730c506>'确定'</span><span class="token punctuation" data-v-c730c506>,</span>
        cancelButtonText<span class="token operator" data-v-c730c506>:</span> <span class="token string" data-v-c730c506>'取消'</span><span class="token punctuation" data-v-c730c506>,</span>
    <span class="token punctuation" data-v-c730c506>}</span><span class="token punctuation" data-v-c730c506>)</span><span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>then</span><span class="token punctuation" data-v-c730c506>(</span><span class="token punctuation" data-v-c730c506>(</span><span class="token parameter" data-v-c730c506><span class="token punctuation" data-v-c730c506>{</span> value <span class="token punctuation" data-v-c730c506>}</span></span><span class="token punctuation" data-v-c730c506>)</span> <span class="token operator" data-v-c730c506>=&gt;</span> <span class="token punctuation" data-v-c730c506>{</span>
        <span class="token keyword" data-v-c730c506>if</span><span class="token punctuation" data-v-c730c506>(</span>value <span class="token operator" data-v-c730c506>&amp;&amp;</span> value<span class="token punctuation" data-v-c730c506>.</span>length <span class="token operator" data-v-c730c506>&gt;</span> <span class="token number" data-v-c730c506>0</span> <span class="token operator" data-v-c730c506>&amp;&amp;</span> value<span class="token punctuation" data-v-c730c506>.</span>length <span class="token operator" data-v-c730c506>&lt;=</span> <span class="token number" data-v-c730c506>5</span><span class="token punctuation" data-v-c730c506>)</span> <span class="token punctuation" data-v-c730c506>{</span>
            <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>features<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>push</span><span class="token punctuation" data-v-c730c506>(</span>value<span class="token punctuation" data-v-c730c506>)</span>
        <span class="token punctuation" data-v-c730c506>}</span> <span class="token keyword" data-v-c730c506>else</span> <span class="token punctuation" data-v-c730c506>{</span>
            <span class="token keyword" data-v-c730c506>this</span><span class="token punctuation" data-v-c730c506>.</span>$message<span class="token punctuation" data-v-c730c506>.</span><span class="token function" data-v-c730c506>error</span><span class="token punctuation" data-v-c730c506>(</span><span class="token string" data-v-c730c506>'输入长度有误'</span><span class="token punctuation" data-v-c730c506>)</span>
        <span class="token punctuation" data-v-c730c506>}</span>
    <span class="token punctuation" data-v-c730c506>}</span><span class="token punctuation" data-v-c730c506>)</span>
<span class="token punctuation" data-v-c730c506>}</span>
</code></pre></div><p data-v-c730c506>最终效果：</p> <p data-v-c730c506><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/imgs/20200521012823.png" alt="" data-v-c730c506></p> <h2 id="_4-后续工作" data-v-c730c506><a href="#_4-后续工作" class="header-anchor" data-v-c730c506>#</a> 4. 后续工作</h2> <p data-v-c730c506>在上一版本的专家系统里面是可以通过两次点击一个属性来实现撤销选中的，但是在这一次的专家系统中给取消了，这是因为由于自定义规则的出现，使得规则变得复杂，所以需要花费很大的工作来完成这样一个撤销的功能；在综合了时间付出以及回报之后，我觉得这并不是一个值得去做的事情，也就没有去做。</p> <p data-v-c730c506>这里我还是给想要完成的同学一些实现的思路</p> <p data-v-c730c506>因为上一版本的专家系统中，我是把一般概念和推导出的概念分开进行计算的，但是当用户可以输入新的概念以及规则之后，没办法像上一版本一样把一般的概念给置为 0，然后计算。所以现在需要创建出来一个新的数据结构，对于 result 数组，定义如下的数据结构：</p> <div class="language-js extra-class" data-v-c730c506><pre class="language-js" data-v-c730c506><code data-v-c730c506><span class="token punctuation" data-v-c730c506>{</span>
    status<span class="token operator" data-v-c730c506>:</span> <span class="token boolean" data-v-c730c506>true</span> <span class="token operator" data-v-c730c506>||</span> <span class="token boolean" data-v-c730c506>false</span><span class="token punctuation" data-v-c730c506>,</span>
    count<span class="token operator" data-v-c730c506>:</span> number <span class="token comment" data-v-c730c506>// 表示有多少个规则可以推导出这个结论</span>
<span class="token punctuation" data-v-c730c506>}</span>
</code></pre></div><p data-v-c730c506>所以当某个概念 I 置为 0 之后，需要遍历所有的规则，如果某个规则中包含这个概念 I ，且修改之前根据这个规则确实是可以推导出概念 O 的话，就把该概念 O 的结果的 count - 1，同时把这个被推导出来的概念 O 入队。遍历完成之后取出队首元素，继续执行遍历操作，直到队列为空。</p> <p data-v-c730c506>看吧，工作还是很大的，所以我就直接加了一个重置选择的开关！</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">修改于:</span> <span class="time">8/30/2020, 4:06:23 PM</span></div></footer> <!----> <div data-v-7cfe0aba><section class="page-edit" data-v-7cfe0aba><div id="vcomments" data-v-7cfe0aba></div></section></div></div> <div class="my-main-right"><div style="font-size:14px"><a href="https://me.csdn.net/jaykm" target="_blank">CSDN</a>    
        <a href="https://github.com/Yiyuery" target="_blank">GitHub</a>   
        <a href="https://juejin.im/user/5c17f022f265da616c65862f" target="_blank">掘金</a>   
        <a href="mailto:xiazhaoyang@live.com">邮件</a></div> <div class="my-menu"><h4 style="margin-top: 0;">目录</h4> <a href="/expert-system-pro-max/#_1-添加新的规则" class="my-menu__lv2">1. 添加新的规则</a><a href="/expert-system-pro-max/#_2-对规则进行排序" class="my-menu__lv2">2. 对规则进行排序</a><a href="/expert-system-pro-max/#多次遍历是否可行" class="my-menu__lv3">多次遍历是否可行</a><a href="/expert-system-pro-max/#拓扑排序" class="my-menu__lv3">拓扑排序</a><a href="/expert-system-pro-max/#插入排序" class="my-menu__lv3">插入排序</a><a href="/expert-system-pro-max/#_3-添加新的概念" class="my-menu__lv2">3. 添加新的概念</a><a href="/expert-system-pro-max/#_4-后续工作" class="my-menu__lv2">4. 后续工作</a></div></div></div> </main></div> <div class="footer">
    © 2019-2020 ❤️ Yiyuery<br> <a href="http://www.beian.miit.gov.cn" target="_blank">皖 ICP 备 19016269 号</a><br> <a href="https://me.csdn.net/jaykm" target="_blank">CSDN</a>    
    <a href="https://github.com/Xerrors" target="_blank">GitHub</a>   
    <a href="https://juejin.im/user/5c17f022f265da616c65862f" target="_blank">掘金</a><br> <a href="mailto:xiazhaoyang@live.com">发送邮件</a></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.839ced15.js" defer></script><script src="/assets/js/4.3fbc1f96.js" defer></script><script src="/assets/js/9.c85ef583.js" defer></script>
  </body>
</html>
