<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>LeetCode 218. 天际线问题 | Yiyuery</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/favicon.ico">
    <meta name="description" content="Yiyuery's 个人博客">
    <link rel="preload" href="/assets/css/0.styles.fac40609.css" as="style"><link rel="preload" href="/assets/js/app.839ced15.js" as="script"><link rel="preload" href="/assets/js/4.3fbc1f96.js" as="script"><link rel="preload" href="/assets/js/49.f43fa070.js" as="script"><link rel="prefetch" href="/assets/js/1.43a347b2.js"><link rel="prefetch" href="/assets/js/10.9753ee5d.js"><link rel="prefetch" href="/assets/js/11.96c59566.js"><link rel="prefetch" href="/assets/js/12.2c50efec.js"><link rel="prefetch" href="/assets/js/13.5d6e55a8.js"><link rel="prefetch" href="/assets/js/14.fc442e96.js"><link rel="prefetch" href="/assets/js/15.24339c79.js"><link rel="prefetch" href="/assets/js/16.1587d289.js"><link rel="prefetch" href="/assets/js/17.44142bfd.js"><link rel="prefetch" href="/assets/js/18.994bb200.js"><link rel="prefetch" href="/assets/js/19.ca759cda.js"><link rel="prefetch" href="/assets/js/2.52d476cc.js"><link rel="prefetch" href="/assets/js/20.979ad63c.js"><link rel="prefetch" href="/assets/js/21.fecc9d80.js"><link rel="prefetch" href="/assets/js/22.3e99d924.js"><link rel="prefetch" href="/assets/js/23.951d9b97.js"><link rel="prefetch" href="/assets/js/24.bad04352.js"><link rel="prefetch" href="/assets/js/25.ce195067.js"><link rel="prefetch" href="/assets/js/26.7b3581a7.js"><link rel="prefetch" href="/assets/js/27.efc77ae3.js"><link rel="prefetch" href="/assets/js/28.16eb2f91.js"><link rel="prefetch" href="/assets/js/29.7772d15e.js"><link rel="prefetch" href="/assets/js/30.3870d4d1.js"><link rel="prefetch" href="/assets/js/31.0f4cfbf5.js"><link rel="prefetch" href="/assets/js/32.29d81c04.js"><link rel="prefetch" href="/assets/js/33.28affd1f.js"><link rel="prefetch" href="/assets/js/34.d28c7114.js"><link rel="prefetch" href="/assets/js/35.d7bb0604.js"><link rel="prefetch" href="/assets/js/36.ebab3576.js"><link rel="prefetch" href="/assets/js/37.0eb5a00d.js"><link rel="prefetch" href="/assets/js/38.9db427c3.js"><link rel="prefetch" href="/assets/js/39.53ecfed9.js"><link rel="prefetch" href="/assets/js/40.b2df18d9.js"><link rel="prefetch" href="/assets/js/41.b6970575.js"><link rel="prefetch" href="/assets/js/42.5d438713.js"><link rel="prefetch" href="/assets/js/43.0f984b43.js"><link rel="prefetch" href="/assets/js/44.4a9567c2.js"><link rel="prefetch" href="/assets/js/45.e77b2e3a.js"><link rel="prefetch" href="/assets/js/46.db689d82.js"><link rel="prefetch" href="/assets/js/47.ca290c98.js"><link rel="prefetch" href="/assets/js/48.cc29300b.js"><link rel="prefetch" href="/assets/js/5.8663838d.js"><link rel="prefetch" href="/assets/js/50.5ac4404a.js"><link rel="prefetch" href="/assets/js/51.20121ae0.js"><link rel="prefetch" href="/assets/js/52.d225ba88.js"><link rel="prefetch" href="/assets/js/53.adeb5a3a.js"><link rel="prefetch" href="/assets/js/54.a4dc7855.js"><link rel="prefetch" href="/assets/js/55.4b88ddc7.js"><link rel="prefetch" href="/assets/js/56.a13331f5.js"><link rel="prefetch" href="/assets/js/57.885d087b.js"><link rel="prefetch" href="/assets/js/58.a3064fd9.js"><link rel="prefetch" href="/assets/js/59.7e0d1f6e.js"><link rel="prefetch" href="/assets/js/6.83d9063b.js"><link rel="prefetch" href="/assets/js/60.33d66471.js"><link rel="prefetch" href="/assets/js/61.d332eaa5.js"><link rel="prefetch" href="/assets/js/62.8eaf5a15.js"><link rel="prefetch" href="/assets/js/63.6e0c7f61.js"><link rel="prefetch" href="/assets/js/64.17534d3f.js"><link rel="prefetch" href="/assets/js/65.40d814d7.js"><link rel="prefetch" href="/assets/js/66.9279a738.js"><link rel="prefetch" href="/assets/js/67.5cdb9fd6.js"><link rel="prefetch" href="/assets/js/68.26c5c99d.js"><link rel="prefetch" href="/assets/js/69.d349f923.js"><link rel="prefetch" href="/assets/js/7.6cb83fee.js"><link rel="prefetch" href="/assets/js/8.d6104416.js"><link rel="prefetch" href="/assets/js/9.c85ef583.js">
    <link rel="stylesheet" href="/assets/css/0.styles.fac40609.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><!----> <div id="my-bg"></div> <header class="navbar my-nav"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logoko.png" alt="Yiyuery" class="logo"> <span class="site-name can-hide">Yiyuery</span></a> <div class="links"><div class="color-picker"><a class="color-button">
		切换
	</a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">切换主题</h4> <ul class="color-mode-options"><li class="dark">暗</li><li class="auto active">自动</li><li class="light">亮</li></ul></div></div></div> <!----> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">📃 文章</a></div><div class="nav-item"><a href="/zhuanlan/" class="nav-link">📰 专栏</a></div><div class="nav-item"><a href="/zone/" class="nav-link">🤪 动态</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">🔨 工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">🚥 导航</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">🔗 友链</a></li></ul></div></div> <!----></nav> <a href="https://github.com/Yiyuery/" target="_blank" class="can-hide" style="display: flex; align-items: center; margin-left: 10px;"><img src="/github.png" class="my-svg" style="width: 1.4rem; height: 1.4rem;"></a></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">📃 文章</a></div><div class="nav-item"><a href="/zhuanlan/" class="nav-link">📰 专栏</a></div><div class="nav-item"><a href="/zone/" class="nav-link">🤪 动态</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">🔨 工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/" class="nav-link">🚥 导航</a></li><li class="dropdown-item"><!----> <a href="/links/" class="nav-link">🔗 友链</a></li></ul></div></div> <!----></nav>  <!----> </aside> <div><main class="page need-zoom"> <div class="my-main"><div class="my-main-left"><div class="my-title-box"><h2>LeetCode 218. 天际线问题</h2> <div class="my-title-info"><span id="/leetcode/the-skyline-problem/" data-flag-title="LeetCode 218. 天际线问题" class="leancloud-visitors"><span>作者：玉川</span>  
            <span>2020 年 6 月 20 日  </span> <i class="el-icon-view" style="margin-right: 3px;"></i> <span class="leancloud-visitors-count"></span></span></div></div> <div class="theme-default-content content__default"><h2 id="_1-题目"><a href="#_1-题目" class="header-anchor">#</a> 1. 题目</h2> <p>城市的天际线是从远处观看该城市中所有建筑物形成的轮廓的外部轮廓。现在，假设您获得了城市风光照片（图A）上显示的所有建筑物的位置和高度，请编写一个程序以输出由这些建筑物形成的天际线（图B）。</p> <p>链接：https://leetcode-cn.com/problems/the-skyline-problem</p> <p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/imgs/20200620154703.png" alt=""></p> <p>例如，图A中所有建筑物的尺寸记录为：<code>[ [2 9 10], [3 7 15], [5 12 12], [15 20 10], [19 24 8] ]</code>。</p> <p>输出是以<code>[ [x1,y1], [x2, y2], [x3, y3], ... ]</code>格式的“关键点”（图B中的红点）的列表，它们唯一地定义了天际线。关键点是水平线段的左端点。请注意，最右侧建筑物的最后一个关键点仅用于标记天际线的终点，并始终为零高度。此外，任何两个相邻建筑物之间的地面都应被视为天际线轮廓的一部分。</p> <p>例如，图B中的天际线应该表示为：<code>[ [2 10], [3 15], [7 12], [12 0], [15 10], [20 8], [24, 0] ]</code>。</p> <p>说明:</p> <ul><li>任何输入列表中的建筑物数量保证在 <code>[0, 10000]</code> 范围内。</li> <li>输入列表已经按左 <code>x</code> 坐标 <code>Li</code>  进行升序排列。</li> <li>输出列表必须按 <code>x</code> 位排序。</li> <li>输出天际线中不得有连续的相同高度的水平线。例如 <code>[...[2 3], [4 5], [7 5], [11 5], [12 7]...]</code> 是不正确的答案；三条高度为 5 的线应该在最终输出中合并为一个：<code>[...[2 3], [4 5], [12 7], ...]</code></li></ul> <h2 id="_2-解题思路"><a href="#_2-解题思路" class="header-anchor">#</a> 2. 解题思路</h2> <h3 id="开始的思路"><a href="#开始的思路" class="header-anchor">#</a> 开始的思路</h3> <p>思路其实很容易想到，就像是一条流水线一样，拿着一根垂直线沿着X轴方向移动，每一个时刻都判断当前建筑的最高的那个建筑的高度，跟上一个时刻的最高的高度相比，如果不一样那么就代表这个点是一个关键点。</p> <p>同时，把当前时刻的建筑保存在一个数组里面，方法是需要在每一个时刻都检查是否有新的建筑进入数组，之后需要检查是否有建筑结束了。</p> <p>但是恐怖就在于，超时了，这里引用一位网友的话：</p> <p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/imgs/20200620132657.png" alt=""></p> <h3 id="自行优化"><a href="#自行优化" class="header-anchor">#</a> 自行优化</h3> <p>这时候来分析一下这个用例的特点：这个建筑特别大，特别高，只有一个。所以就是说我们在每一个时刻都要判断是都有新的建筑以及是否有建筑被删除，然后在这个例子里面，这些判断都是徒劳的，只有一个建筑。所以优化的方向就是不要对这些无用点进行检测，所以采用的办法就是把原本的扫描点替换成有意义的点，也就是建筑物的边缘点：</p> <div class="language-python extra-class"><pre class="language-python"><code>points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> k <span class="token keyword">in</span> buildings<span class="token punctuation">:</span>
	<span class="token keyword">if</span> k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> points<span class="token punctuation">:</span>
		points<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> points<span class="token punctuation">:</span>
		points<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
points<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>但是，新的问题就出现了，<code>[[1,2,1],[1,2,2],[1,2,3]]</code> 这个例子的特点是三个建筑物重叠但是高度不一样，按理说应该不是问题，但是出现了一个意想不到的错误，那么是遍历删除的时候出现的错误；当我们的扫描线到达点 2 的时候，这三个建筑都应当从数组中删除，但是：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">for</span> build <span class="token keyword">in</span> q<span class="token punctuation">:</span>
    <span class="token keyword">if</span> build<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
        q<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>build<span class="token punctuation">)</span>
</code></pre></div><p>这个方法删除元素的时候，并不能够删除所有元素，比如下面这个例子：</p> <div class="language-python extra-class"><pre class="language-python"><code>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> a<span class="token punctuation">:</span>
	<span class="token keyword">if</span> i <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
		a<span class="token punctuation">.</span>remove<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>

<span class="token comment"># [2, 4, 6]</span>
</code></pre></div><p>所以这时候采用过滤的办法来解决这个问题：</p> <div class="language-python extra-class"><pre class="language-python"><code>q <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>此时完整的代码：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">getSkyline</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> buildings<span class="token punctuation">:</span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> cur_height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span>
        m <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>buildings<span class="token punctuation">)</span>
        points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> buildings<span class="token punctuation">:</span>
            <span class="token keyword">if</span> k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> points<span class="token punctuation">:</span>
                points<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> points<span class="token punctuation">:</span>
                points<span class="token punctuation">.</span>append<span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        points<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            <span class="token comment"># 添加新来的建筑</span>
            <span class="token keyword">while</span> j <span class="token operator">!=</span> m <span class="token keyword">and</span> buildings<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>
                q<span class="token punctuation">.</span>append<span class="token punctuation">(</span>buildings<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
                j <span class="token operator">+=</span> <span class="token number">1</span>

            <span class="token comment"># 判断是否结束</span>
            <span class="token keyword">if</span> j <span class="token operator">==</span> m <span class="token keyword">and</span> <span class="token keyword">not</span> q<span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            
            temp <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token comment"># 清除已经过去的建筑</span>
            q <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&gt;</span> points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token comment"># 检测当前点最高的建筑</span>
            <span class="token keyword">for</span> build <span class="token keyword">in</span> q<span class="token punctuation">:</span>
                temp <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> build<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> temp <span class="token operator">!=</span> cur_height<span class="token punctuation">:</span>
                cur_height <span class="token operator">=</span> temp
                res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>points<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> temp<span class="token punctuation">]</span><span class="token punctuation">)</span>
            i <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">return</span> res
</code></pre></div><p>然而，又超时了，你看看这例子，是人干的事不：</p> <p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/imgs/20200620140831.png" alt=""></p> <p>我瞬间感觉到了我这个算法的绝望，扫描线每一次都要对这么多建筑进行扫描，还能优化啥？？？？</p> <h3 id="借鉴大佬的思路"><a href="#借鉴大佬的思路" class="header-anchor">#</a> 借鉴大佬的思路</h3> <p>最终还是打算借鉴一下大佬的思路，这个算法的思路跟我的最不一样的地方：</p> <ol><li>保存了所有的点，包括相同的左端点以及右端点，同时可以对左右端点进行识别；</li> <li>使用堆的数据结构来保存当前的建筑的高度，可以更快的找到最高的建筑的高度，这也是我上面的算法出现超时的主要原因。</li> <li>所有的点的排序巧妙的使用了负数高度这样一个情况。</li></ol> <h2 id="_3-最终代码以及运行结果"><a href="#_3-最终代码以及运行结果" class="header-anchor">#</a> 3. 最终代码以及运行结果</h2> <p>所以对我的代码进行了修改：</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">import</span> heapq
<span class="token keyword">class</span> <span class="token class-name">Solution</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">getSkyline</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> buildings<span class="token punctuation">:</span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> List<span class="token punctuation">[</span>List<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token comment"># 保存所有的点</span>
        points <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> build <span class="token keyword">in</span> buildings<span class="token punctuation">:</span>
            points<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>build<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token operator">-</span>build<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            points<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>build<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>  build<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        points<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>key<span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		
        <span class="token comment"># 用来保存当前扫描线所经过的建筑的高度，用堆来表示</span>
        heights <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token comment"># 因为在堆里面删除元素需要更多的时间开销，所以先把需要删除的元素保存起来</span>
        should_del <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> 
		
        <span class="token comment"># 保存当前的高度</span>
        cur_height <span class="token operator">=</span> <span class="token number">0</span>

        <span class="token keyword">for</span> point <span class="token keyword">in</span> points<span class="token punctuation">:</span>
            <span class="token keyword">if</span> point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span> heapq<span class="token punctuation">.</span>heappush<span class="token punctuation">(</span>heights<span class="token punctuation">,</span> point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">elif</span> should_del<span class="token punctuation">.</span>get<span class="token punctuation">(</span>point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
                should_del<span class="token punctuation">[</span>point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span> <span class="token comment"># 保存需要删除的次数，删除的时候，删除一次</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                should_del<span class="token punctuation">[</span>point<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>

            <span class="token comment"># 如果当前堆顶元素是应该删除的元素就先删除掉</span>
            <span class="token keyword">while</span> heights <span class="token keyword">and</span> <span class="token operator">-</span>heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">in</span> should_del<span class="token punctuation">:</span>
                temp <span class="token operator">=</span> <span class="token operator">-</span>heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                heapq<span class="token punctuation">.</span>heappop<span class="token punctuation">(</span>heights<span class="token punctuation">)</span>
                should_del<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">-=</span> <span class="token number">1</span>
                <span class="token keyword">if</span> should_del<span class="token punctuation">[</span>temp<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                    should_del<span class="token punctuation">.</span>pop<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>
            
            maxH <span class="token operator">=</span> <span class="token operator">-</span>heights<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">if</span> heights <span class="token keyword">else</span> <span class="token number">0</span>
            <span class="token keyword">if</span> maxH <span class="token operator">!=</span> cur_height<span class="token punctuation">:</span>
                cur_height <span class="token operator">=</span> maxH
                res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>point<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> cur_height<span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> res
</code></pre></div><p><img src="https://xerrors.oss-cn-shanghai.aliyuncs.com/imgs/20200620154006.png" alt=""></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">修改于:</span> <span class="time">8/30/2020, 4:06:23 PM</span></div></footer> <!----> <div data-v-7cfe0aba><section class="page-edit" data-v-7cfe0aba><div id="vcomments" data-v-7cfe0aba></div></section></div></div> <div class="my-main-right"><div style="font-size:14px"><a href="https://me.csdn.net/jaykm" target="_blank">CSDN</a>    
        <a href="https://github.com/Yiyuery" target="_blank">GitHub</a>   
        <a href="https://juejin.im/user/5c17f022f265da616c65862f" target="_blank">掘金</a>   
        <a href="mailto:xiazhaoyang@live.com">邮件</a></div> <div class="my-menu"><h4 style="margin-top: 0;">目录</h4> <a href="/leetcode/the-skyline-problem/#_1-题目" class="my-menu__lv2">1. 题目</a><a href="/leetcode/the-skyline-problem/#_2-解题思路" class="my-menu__lv2">2. 解题思路</a><a href="/leetcode/the-skyline-problem/#开始的思路" class="my-menu__lv3">开始的思路</a><a href="/leetcode/the-skyline-problem/#自行优化" class="my-menu__lv3">自行优化</a><a href="/leetcode/the-skyline-problem/#借鉴大佬的思路" class="my-menu__lv3">借鉴大佬的思路</a><a href="/leetcode/the-skyline-problem/#_3-最终代码以及运行结果" class="my-menu__lv2">3. 最终代码以及运行结果</a></div></div></div> </main></div> <div class="footer">
    © 2019-2020 ❤️ Yiyuery<br> <a href="http://www.beian.miit.gov.cn" target="_blank">皖 ICP 备 19016269 号</a><br> <a href="https://me.csdn.net/jaykm" target="_blank">CSDN</a>    
    <a href="https://github.com/Xerrors" target="_blank">GitHub</a>   
    <a href="https://juejin.im/user/5c17f022f265da616c65862f" target="_blank">掘金</a><br> <a href="mailto:xiazhaoyang@live.com">发送邮件</a></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.839ced15.js" defer></script><script src="/assets/js/4.3fbc1f96.js" defer></script><script src="/assets/js/49.f43fa070.js" defer></script>
  </body>
</html>
